<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>2048</title>
<link rel="stylesheet" href="../style.css">
<style>.board{width:300px;height:300px;margin:12px auto;display:grid;grid-template-columns:repeat(4,1fr);gap:8px}.tile{background:rgba(255,255,255,0.08);display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:1.4rem;border-radius:6px}</style>
</head>
<body>
<div class="container">
  <h1>ðŸ”² 2048</h1>
  <div id="board" class="board"></div>
  <div style="margin-top:8px"><button onclick="start()">Restart</button> <span id="score">Score:0</span></div>
  <a class="back" href="../index.html">â¬… Back to Hub</a>
</div>
<script>
let grid, score=0;
function start(){
  grid=Array.from({length:4},()=>Array(4).fill(0)); score=0; addTile(); addTile(); render();
}
function addTile(){
  const empties=[];
  for(let r=0;r<4;r++) for(let c=0;c<4;c++) if(grid[r][c]===0) empties.push([r,c]);
  if(!empties.length) return;
  const [r,c]=empties[Math.floor(Math.random()*empties.length)];
  grid[r][c]= Math.random()<0.9?2:4;
}
function render(){
  const b=document.getElementById('board'); b.innerHTML='';
  for(let r=0;r<4;r++) for(let c=0;c<4;c++){
    const t=document.createElement('div'); t.className='tile'; t.textContent=grid[r][c]||''; b.appendChild(t);
  }
  document.getElementById('score').textContent='Score:'+score;
}
function moveLeft(){
  let moved=false;
  for(let r=0;r<4;r++){
    let row = grid[r].filter(v=>v);
    for(let i=0;i<row.length-1;i++){
      if(row[i]===row[i+1]){ row[i]*=2; score+=row[i]; row.splice(i+1,1); }
    }
    while(row.length<4) row.push(0);
    for(let c=0;c<4;c++){ if(grid[r][c]!==row[c]) moved=true; grid[r][c]=row[c]; }
  }
  return moved;
}
function rotate(){ grid = grid[0].map((_,i)=> grid.map(row=>row[i]).reverse()); }
document.addEventListener('keydown', e=>{
  let moved=false;
  if(e.key==='ArrowLeft') moved=moveLeft();
  if(e.key==='ArrowRight'){ rotate(); rotate(); moved=moveLeft(); rotate(); rotate(); }
  if(e.key==='ArrowUp'){ rotate(); rotate(); rotate(); moved=moveLeft(); rotate(); }
  if(e.key==='ArrowDown'){ rotate(); moved=moveLeft(); rotate(); rotate(); rotate(); }
  if(moved){ addTile(); render(); if(!hasMoves()) alert('Game Over! Score:'+score); }
});
function hasMoves(){
  for(let r=0;r<4;r++) for(let c=0;c<4;c++){
    if(grid[r][c]===0) return true;
    if(c<3 && grid[r][c]===grid[r][c+1]) return true;
    if(r<3 && grid[r][c]===grid[r+1][c]) return true;
  }
  return false;
}
start();
</script>
</body>
</html>
